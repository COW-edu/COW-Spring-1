## MVC 패턴이란?

Model-View-Controller의 약자로, 애플리케이션을 세 가지 역할로 구분한 방법론

### 모델

데이터를 가진 객체

규칙

- 사용자가 편집하려는 모든 데이터를 가지고 있어야 함
- 뷰, 컨트롤러에 대한 어떤 정보도 알지 말아야 함

### 뷰

사용자에게 보여지는 부분

규칙

- 모델이 가진 정보를 저장하면 안 됨
- 모델, 컨트롤러와 같이 다른 구성 요소를 알면 안 됨

### 컨트롤러

사용자의 요청을 파악 후 요청에 맞는 데이터를 모델로부터 뷰로 전달함

규칙

- 모델, 뷰에 대해 알고 있어야 함

<aside>
💡 계산기를 MVC패턴을 사용해 만들어보면 어떻게 될까?

</aside>

- Model
    - 데이터 베이스 및 데이터 표현
    - 유저가 입력하는 숫자를 저장, 이전 계산 기록을 저장
- View
    - 계산 결과를 보여줌
    - 현재 입력중인 숫자나 사칙연산이 무엇인지 보여줌
- Controller
    - 입력값이 초과하지 않았는지
    - 사용자가 View에서 입력한 숫자를 Model로 변경 해 줌
    - 사칙연산 계산

다음과 같이 구성할 수 있다.

### MVC 패턴의 한계

시스템의 규모가 커질수록, 모델과 뷰가 M : N 관계로 매우 복잡해진다. 이렇게 서로 높아진 의존성은 문제를 일으킬 수 있다.

컨트롤러에 모든 로직이 들어가 역할 분산의 필요성이 생긴다.

## Layerd Architecture

Presentation Layer: 사용자 - 애플리케이션 간 인터페이스 담당, 요청과 응답을 처리함

Business Layer (Service, Domain): 핵심 비즈니스 로직을 담당한다.

Persistance Layer: 데이터베이스와 상호작용한다. (데이터에 대한 영속성 유지)

Database Layer: 데이터베이스를 뜻한다.

계층형 아키텍처는 상위 계층이 하위 계층에 의존하는 구조를 가짐

각 계층은 그 하위 계층에 대해서만 의존하기 때문에 특정 계층의 유지보수, 확장이 용이하다.

변경의 영향을 줄이기 위해서 각 계층은 닫혀 있는 관계이다. 닫혀 있다는 것은 한 계층에서 다른 계층으로 이동할 때, 그 사이에 계층이 있다면 무조건 그 계층도 통과해야 함을 뜻한다.

## 서블릿

웹 애플리케이션 서버 내에서 실행되는 Java 프로그램

동적 웹 페이지를 만들고 웹 응용 프로그램을 구현함

Apache Tomcat은 서블릿이 웹 애플리케이션으로 실행되게 해주는 서블릿 컨테이너 중 하나임

### 웹 서버

- HTTP 프로토콜을 기반으로 요청을 받으면 정적 컨텐츠를 제공하는 서버
- Apache, Nginx 등

### WAS

- DB 조회 등 다양한 로직 처리 요구하는 동적 컨텐츠 제공
- JSP, Servlet 구동환경을 제공해주기 때문에 서블릿 컨테이너, 웹 컨테이너라고도 불림
- Tomcat, JBoss 등

요청 → WAS에 위임 → WAS는 각 요청에 해당하는 서블릿 실행 → 서블릿은 결과를 반환해 클라이언트로 응답 전송

## 스프링 MVC 구조

<img width="622" alt="스크린샷 2023-08-22 오전 1 24 08" src="https://github.com/Youngcircle-kim/CowSubway-BackEnd/assets/104254012/6f8487c1-a92b-4733-b8b3-7f497bb4c189">

### DispatcherServlet

HTTP 프로토콜로 들어오는 모든 요청을 **가장 먼저 받아 적합한 컨트롤러에 위임**해주는 프론트 컨트롤러

정적 자원 요청까지도 모두 가로채기 때문에 정적 자원을 불러오지 못하는 경우도 생겼다. 그래서 정적 자원 요청과 애플리케이션 요청을 분리하거나, 먼저 애플리케이션 요청을 탐색하고 없다면 정적 자원 요청으로 처리하는 방식을 사용한다.

### 디스패처 서블릿의 동작 과정

1. 클라이언트 요청을 디스패처 서블릿이 받음
2. 요청 정보를 통해 요청을 위임할 컨트롤러를 탐색함
3. 요청을 컨트롤러로 위임할 핸들러 어댑터를 찾아서 전달함
4. 핸들러 어댑터가 컨트롤러로 요청을 위임함
5. 비즈니스 로직을 처리함
6. 컨트롤러가 값을 반환함
7. 핸들러 어댑터가 반환값을 처리함
8. 서버의 응답을 클라이언트로 반환함

### HandlerMapping

한 요청에 대해 어느 컨트롤러가 그 요청을 처리할 수 있는지를 식별하는 역할을 함

요청이 오면 Http Method나 URI를 사용해 요청 정보를 만들고, HashMap에서 요청을 처리할 대상(HandlerMethod)을 찾은 후 HandlerExecutionChain으로 감싸서 반환한다. 이는 컨트롤러로 요청을 넘겨주기 전에 처리해야 하는 인터셉터 등을 포함하기 위해서이다.

## 어노테이션 / Spring 프레임워크의 주요 어노테이션

### 어노테이션이란?

프로그램에게 추가적인 정보를 제공해주는 메타데이터

코드 사이에 주석처럼 쓰이며 특정 의미, 기능을 갖게 하는 기술

### 어노테이션 사용 이유

컴파일러에게 코드 작성 문법 에러를 검사하도록 정보를 제공함

빌드, 배치 시 코드를 자동으로 생성할 수 있도록 정보를 제공함

런타임 시 특정 기능을 실행하도록 정보를 제공함

### 종류

- @ComponentScan

@Component 어노테이션이 붙은 클래스에 대해 bean 인스턴스를 생성함

- @Component

개발자가 직접 작성한 클래스를 Bean으로 등록함

- @Bean

개발자가 제어할 수 없는 외부 라이브러리 등을 Bean으로 등록할 때 사용됨 (메소드 단위)

- @Autowired

필드, 주입자, 생성자에서 사용되며 의존성을 주입해줌

- @Configuration

클래스에 적용하고 @Bean을 메소드에 적용하면 @Autowired로 Bean을 부를 수 있다.

- @Qualifier(”id123”)

같은 타입의 Bean 객체가 있을 때 해당 아이디를 적어 원하는 Bean이 주입될 수 있도록 하는 어노테이션

- @PostConstruct, @PreConstruct

의존하는 객체 생성 이후 초기화 작업을 위해 객체 생성 전 / 후에 실행해야 할 메소드 앞에 붙임

- @PreDestroy

객체 제거하기 전에 해야 할 작업을 수행하기 위해 사용

- @RequestMapping

요청 URL을 어떤 Method가 처리할 지 매핑해주는 어노테이션
